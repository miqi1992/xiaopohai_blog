``` sql
-- 商户申请
CREATE TABLE `merchant_apply`  
(  
    `id`                 int(10)      NOT NULL AUTO_INCREMENT COMMENT '商户编号',  
    `admin_id`           int          NOT NULL COMMENT '用户编号',  
    `second_admin_id`    int(255)     DEFAULT NULL COMMENT '次级用户编号',  
    `category_id`        varchar(255) NOT NULL COMMENT '类目id',  
    `second_category_id` varchar(255) NOT NULL COMMENT '二级类目id',  
    `group_id`           int          NOT NULL COMMENT '集团id',  
    `rate`               decimal(10, 2) DEFAULT '0.00' COMMENT '商户费率',  
    `name`               varchar(255)    DEFAULT NULL COMMENT '商户名称',  
    `score`              int            DEFAULT '0' COMMENT '商户评分',  
    `logo`               varchar(255)   DEFAULT NULL COMMENT '商户图标',  
    `phone`              varchar(20)    DEFAULT NULL COMMENT '手机号码',  
    `address`            varchar(255)   DEFAULT NULL COMMENT '详细地址',  
    `longitude`          decimal(10, 6) DEFAULT NULL COMMENT '经度',  
    `latitude`           decimal(10, 6) DEFAULT NULL COMMENT '纬度',  
    `images`             text COMMENT '商户图片,多张图片逗号分隔',  
    `business_hours`     varchar(64)    DEFAULT NULL COMMENT '营业时间',  
    `seq`             int          NOT NULL COMMENT '序号',  
    `create_user`        varchar(64)    DEFAULT NULL COMMENT '创建人',  
    `status`             int            DEFAULT '1' COMMENT '商户状态：0-申请中，1-审核通过，3-审核不通过',  
    `create_time`        datetime       DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',  
    `update_user`        varchar(64)    DEFAULT NULL COMMENT '修改人',  
    `update_time`        datetime       DEFAULT NULL COMMENT '修改时间',  
    `is_delete`          int            DEFAULT '0',  
    PRIMARY KEY (`id`)  
) ENGINE = InnoDB  
  DEFAULT CHARSET = utf8mb3;

-- 商户表
CREATE TABLE `merchant`  
(  
    `id`                 int(10)      NOT NULL AUTO_INCREMENT COMMENT '商户编号',  
    `admin_id`           int          NOT NULL COMMENT '用户编号',  
    `second_admin_id`    varchar(255)     NOT NULL COMMENT '次级用户编号',  
    `category_id`        varchar(255) NOT NULL COMMENT '类目id',  
    `second_category_id` varchar(255) NOT NULL COMMENT '二级类目id',  
    `group_id`           int          NOT NULL COMMENT '集团id',  
    `rate`               decimal(10, 2) DEFAULT '0.00' COMMENT '商户费率',  
    `name`               varchar(255)    DEFAULT NULL COMMENT '商户名称',  
    `score`              int            DEFAULT '0' COMMENT '商户评分',  
    `logo`               varchar(255)   DEFAULT NULL COMMENT '商户图标',  
    `phone`              varchar(20)    DEFAULT NULL COMMENT '手机号码',  
    `address`            varchar(255)   DEFAULT NULL COMMENT '详细地址',  
    `longitude`          decimal(10, 6) DEFAULT NULL COMMENT '经度',  
    `latitude`           decimal(10, 6) DEFAULT NULL COMMENT '纬度',  
    `images`             text COMMENT '商户图片,多张图片逗号分隔',  
    `seq`             int          NOT NULL COMMENT '序号',  
    `business_hours`     varchar(64)    DEFAULT NULL COMMENT '营业时间',  
    `use_meal_card_flag` int            DEFAULT '0' COMMENT '是否使用餐券：0-不可使用，1-可以用',  
    `recommend`      int            NOT NULL COMMENT '0不置顶,1置顶',  
    `index_status` int            DEFAULT '0' COMMENT '0显示,1不显示',  
    `create_user`        varchar(64)    DEFAULT NULL COMMENT '创建人',  
    `create_time`        datetime       DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',  
    `update_user`        varchar(64)    DEFAULT NULL COMMENT '修改人',  
    `update_time`        datetime       DEFAULT NULL COMMENT '修改时间',  
    `is_delete`          int            DEFAULT '0',  
    PRIMARY KEY (`id`),  
    UNIQUE KEY `unique_user_id` (`admin_id`) COMMENT '用户id唯一索引'  
) ENGINE = InnoDB  DEFAULT CHARSET = utf8mb4  COMMENT ='商户表';

-- 分类
CREATE TABLE `category` (  
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '类目id',  
  `name` varchar(50) NOT NULL COMMENT '类目名称',  
  `level` int NOT NULL COMMENT '类目层级',  
  `parent_id` bigint NOT NULL DEFAULT '0' COMMENT '根节点为0',  
  `is_leaf` int DEFAULT NULL COMMENT '是否叶子',  
  `sort` int DEFAULT NULL COMMENT '排序',  
  `is_enable` int NOT NULL COMMENT '是否开启(0关闭,1开启)',  
  `icon` varchar(256) DEFAULT NULL COMMENT '图片',  
  `mark` varchar(256) DEFAULT NULL COMMENT '标志',  
  `recommend_flag` int DEFAULT '0' COMMENT '是否推荐：0-不推荐，1-推荐',  
  `use_meal_card_flag` int DEFAULT '0' COMMENT '是否使用餐券：0-不可使用，1-可以用',  
  `is_delete` int DEFAULT '0' COMMENT '是否删除',  
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',  
  `create_user` varchar(50) DEFAULT '' COMMENT '创建人',  
  `update_time` datetime DEFAULT NULL COMMENT '修改时间',  
  `update_user` varchar(50) DEFAULT NULL COMMENT '修改人',  
  PRIMARY KEY (`id`),  
  UNIQUE KEY `unique_name_level_delete` (`name`,`level`,`is_delete`),  
  KEY `index_parent_id` (`parent_id`)  
) ENGINE=InnoDB AUTO_INCREMENT=59 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='类目表'

```



``` sql
-- 商户申请表 merchant_apply
INSERT INTO merchant_apply (  
id,admin_id, second_admin_id, category_id, second_category_id, group_id, rate, name, score, logo, phone, address, longitude, latitude, images, business_hours, status, seq, create_user, create_time, update_user, update_time,is_delete)  
SELECT  
id, uid, NULL, fenlei, erjifenlei,jituanid, feilv, name, pingji, icon, tel, weizhi, CAST(IFNULL(NULLIF(jing, 'undefined'), 0) AS DECIMAL(10, 6)),CAST(IFNULL(NULLIF(wei, 'undefined'), 0) AS DECIMAL(10, 6)), pics, ondate, status, orderid, uid, time , uid, time, 0  
FROM sqsywl_2024.ims_zt_sjtg_shanghu_sq;


-- 商户表 merchant
INSERT INTO merchant (  
id,admin_id, second_admin_id, category_id, second_category_id, group_id, rate, name, score, logo, phone, address, longitude, latitude, images, business_hours, seq, use_meal_card_flag, index_status, recommend)  
SELECT  
id, uid, uidsub, fenlei, erjifenlei,jituanid, feilv, name, pingji, icon, tel, weizhi, CAST(IFNULL(NULLIF(jing, 'undefined'), 0) AS DECIMAL(10, 6)),CAST(IFNULL(NULLIF(wei, 'undefined'), 0) AS DECIMAL(10, 6)), pics, ondate, orderid, canka,index_status, tuijian  
FROM sqsywl_2024.ims_zt_sjtg_shanghu;
update merchant set use_meal_card_flag = 1 where use_meal_card_flag = 2;


-- 



```